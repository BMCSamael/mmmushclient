<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- Saved on Sunday, October 21, 2012, 10:03 PM -->
<!-- MuClient version 4.85 -->

<!-- Plugin "play_sounds" generated by Plugin Wizard -->

<muclient>

<plugin
   name="play_sounds"
   author="Ruthgul"
   id="4327c10cd9ae383bef04a7fc"
   language="Lua"
   purpose="plays a sound from a file"
   date_written="2012-10-21 22:02:58"
   date_modified="2012-12-18 07:55:52"
   requires="4.71"
   version="1.0"
   >

<description trim="y">

<![CDATA[

.---------------.
 | play_sounds |
`---------------'

Plays a .wav or .mp3 sound file, from the default directory (mushclient/sounds).


** REQUIRES **

- The .wav, .mp3, or .ogg sound files you want to use must be placed in the MUSHclient/sounds folder.


Syntax:

* play a sound <name>.{wav|mp3|ogg}  - eg, play a sound danger.wav


Author: Ruthgul

Latest version:
http://github.com/MateriaMagicaLLC/mm-mushclient-scripts

]]>

</description>

</plugin>



<!--  Aliases  -->

<aliases>

  <alias
   enabled="y"
   match="^play[ ]+a[ ]+sound[ ]+(?P&lt;name&gt;.+)$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>play_a_sound("%&lt;name&gt;")
</send>
  </alias>


<!--  Plugin help  -->

  <alias
   enabled="y"
   match="^play(|\_sounds)(|( |\:)help)$"
   regexp="y"
   script="OnHelp"
  >
  </alias>

</aliases>



<!--  Scripts  -->

<script>

<![CDATA[

-----------------
-- plugin stuff
-----------------

function OnPluginInstall()
  Tell("-- " .. GetPluginInfo(GetPluginID(), 1) .. ": type ")
  ColourTell("silver", "black", GetPluginInfo(GetPluginID(), 1) .. " help")
  Note(" to see info about this plugin --")

  path = GetInfo(66) .. "sounds\\"

  played_sounds = {}
end


function OnHelp()
  ColourNote("silver", "black", world.GetPluginInfo(world.GetPluginID(), 3))
  Note("")
  ColourNote("silver", "black", "(this version: " .. os.date("%c", GetPluginInfo(GetPluginID(), 14)) .. ")")
end


function plugin_update_url()
  local t = {
    "https://raw.githubusercontent.com/MateriaMagicaLLC/mm-mushclient-scripts/master/src/play_sounds.xml",
  }
  return (table.concat(t, ";"))
end



-----------------
-- play a sound
-----------------

anti_spam = 0  -- disabled

function play_a_sound(name)
  local f = io.open(path .. name, "r")

  if (f) then
    f:close()
    played_sounds[name] = played_sounds[name] or 0

--    if ((played_sounds[name] + anti_spam) < os.time()) then
      Sound(path .. name)
      played_sounds[name] = os.time()
--    end

  else
    Note("-- play_sounds: I can't find the file " .. path .. name .. " --")
  end
end


]]>

</script>

</muclient>
