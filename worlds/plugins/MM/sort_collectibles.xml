<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- Saved on Tuesday, March 13, 2012, 8:43 PM -->
<!-- MuClient version 4.81 -->

<!-- Plugin "sort_collectibles" generated by Plugin Wizard -->

<muclient>

<plugin
   name="sort_collectibles"
   author="Ruthgul"
   id="ffc9367251d8355fc40c4f67"
   language="Lua"
   purpose="shows collectibles in numeric order"
   date_written="2012-03-13 20:39:25"
   date_modified="2013-08-23 22:28:41"
   requires="4.71"
   version="1.0"
   >

<description trim="y">

<![CDATA[

.---------------------.
 | sort_collectibles |
`---------------------'

Shows items inside a collectibles container (armoire, stamp book, toybox) sorted by number instead of normal/stack order.


Syntax:

* look in <container> to see the contents sorted by collectible number. (eg, look in toybox)

* look <container> shows the contents in their natural (stack) order.


Author: Ruthgul

Latest version:
http://github.com/MateriaMagicaLLC/mm-mushclient-scripts

]]>

</description>

</plugin>



<!--  Triggers  -->

<triggers>

  <trigger
   group="script-collectibles-all"
   keep_evaluating="y"
   match="^\[C\]ontinue \[R\]edraw \[B\]ack \[E\]xit\: $"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>auto_cont()
</send>
  </trigger>


<!-- plates -->

  <trigger
   enabled="y"
   group="script-collectibles"
   keep_evaluating="y"
   match="^A portable glassware armoire contains\:$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>start_plates()
</send>
  </trigger>


  <trigger
   group="script-collectibles-plates"
   keep_evaluating="y"
   match="^[ ]+a decorative plate depicting (?P&lt;name&gt;[A-Za-z0-9 \;\,\.\-\']+) \(\#(?P&lt;num&gt;[0-9]+)\) \((.+?)\)$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>add_plate("%&lt;name&gt;", "%&lt;num&gt;")
</send>
  </trigger>


  <trigger
   group="script-collectibles-plates"
   keep_evaluating="y"
   match="^A total of (.+?) \(110 max\) item(|s) weighing (.+?) st(|s)\, (.+?) pb(|s) \(6 sts\, 0 pbs max\)\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>trigger_style_runs = TriggerStyleRuns
show_plates()
</send>
  </trigger>


<!-- plushies -->

  <trigger
   enabled="y"
   group="script-collectibles"
   keep_evaluating="y"
   match="^A velvet-lined toybox contains\:$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>start_plushies()
</send>
  </trigger>


  <trigger
   group="script-collectibles-plushies"
   keep_evaluating="y"
   match="^[ ]+(a|an) (?P&lt;name&gt;[A-Za-z0-9 \;\,\.\-\']+) plushie \(\#(?P&lt;num&gt;[0-9]+)\) \((.+?)\)$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>add_plushie("%&lt;name&gt;", "%&lt;num&gt;")
</send>
  </trigger>


  <trigger
   group="script-collectibles-plushies"
   keep_evaluating="y"
   match="^A total of (.+?) \(33 max\) item(|s) weighing (.+?) st(|s)\, (.+?) pb(|s) \(6 sts\, 0 pbs max\)\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>trigger_style_runs = TriggerStyleRuns
show_plushies()
</send>
  </trigger>


<!-- stamps -->

  <trigger
   enabled="y"
   group="script-collectibles"
   keep_evaluating="y"
   match="^A stamp collector's book contains\:$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>start_stamps()
</send>
  </trigger>


  <trigger
   group="script-collectibles-stamps"
   keep_evaluating="y"
   match="^[ ]+a stamp commemorating (?P&lt;name&gt;[A-Za-z0-9 \;\,\.\-\']+) \(\#(?P&lt;num&gt;[0-9]+)\)(| \(.+?\) )$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>add_stamp("%&lt;name&gt;", "%&lt;num&gt;")
</send>
  </trigger>


  <trigger
   group="script-collectibles-stamps"
   keep_evaluating="y"
   match="^A total of (.+?) \(33 max\) item(|s) weighing (.+?) st(|s)\, (.+?) pb(|s) \(3 sts\, 50 pbs max\)\.$"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>trigger_style_runs = TriggerStyleRuns
show_stamps()
</send>
  </trigger>

</triggers>


<!--  Plugin help  -->

<aliases>

  <alias
   enabled="y"
   match="^sort_collectibles(|( |\:)help)$"
   regexp="y"
   script="OnHelp"
  >
  </alias>

</aliases>



<!--  Scripts  -->

<script>

<![CDATA[

-----------
-- plugin
-----------

function OnPluginInstall()
  Tell("-- sort_collectibles - type: ")
  ColourTell("silver", "black", GetPluginInfo(GetPluginID (), 1) .. " help")
  Note(" to see info about this plugin --")
end


function OnHelp ()
  ColourNote("silver", "black", world.GetPluginInfo(world.GetPluginID (), 3))
  Note("")
  ColourNote("silver", "black", "(this version: " .. os.date("%c", GetPluginInfo (GetPluginID(), 14)) .. ")")
end


function plugin_update_url()
  local t = {
    "https://raw.githubusercontent.com/MateriaMagicaLLC/mm-mushclient-scripts/master/src/sort_collectibles.xml",
  }
  return (table.concat(t, ";"))
end



------------------
-- general stuff
------------------

function auto_cont()
  SendNoEcho("C")
end



-----------
-- plates
-----------

function start_plates()
  ArrayDelete("aplates")
  ArrayCreate("aplates")
  ColourNote("silver", "black", "A portable glassware armoire contains decorative plates depicting:")
  EnableTriggerGroup("script-collectibles-plates", true)
  EnableTriggerGroup("script-collectibles-all", true)
end


function add_plate(name, num)
  ArraySet("aplates", num, name)
end


function show_plates()
  for key, val in pairs(ArrayListKeys("aplates")) do
    if (tonumber(val) < 10) then
      ColourNote("silver", "black", "     (#" .. val .. ") " .. ArrayGet("aplates", val))

    else
      ColourNote("silver", "black", "    (#" .. val .. ") " .. ArrayGet("aplates", val))
    end
  end

  ArrayDelete("aplates")

  for k, v in ipairs(trigger_style_runs) do
    ColourTell(RGBColourToName(v.textcolour),
               RGBColourToName(v.backcolour),
               v.text)
  end

  Note("")

  EnableTriggerGroup("script-collectibles-plates", false)
  EnableTriggerGroup("script-collectibles-all", false)
end


-------------
-- plushies
-------------

function start_plushies()
  ArrayDelete("aplushies")
  ArrayCreate("aplushies")
  ColourNote("silver", "black", "A velvet-lined toybox contains these plushies:")
  EnableTriggerGroup("script-collectibles-plushies", true)
  EnableTriggerGroup("script-collectibles-all", true)
end


function add_plushie(name, num)
  ArraySet("aplushies", num, name)
end


function show_plushies()
  for key, val in pairs (ArrayListKeys("aplushies")) do
    if (tonumber(val) < 10) then
      ColourNote("silver", "black", "     (#" .. val .. ") " .. ArrayGet("aplushies", val))

    else
      ColourNote("silver", "black", "    (#" .. val .. ") " .. ArrayGet("aplushies", val))
    end
  end

  ArrayDelete("aplushies")

  for k, v in ipairs(trigger_style_runs) do
    ColourTell(RGBColourToName(v.textcolour),
               RGBColourToName(v.backcolour),
               v.text)
  end

  Note("")

  EnableTriggerGroup("script-collectibles-plushies", false)
  EnableTriggerGroup("script-collectibles-all", false)
end


-----------
-- stamps
-----------

function start_stamps()
  ArrayDelete("astamps")
  ArrayCreate("astamps")
  ColourNote("silver", "black", "A stamp collector's book contains stamps commemorating:")
  EnableTriggerGroup("script-collectibles-stamps", true)
  EnableTriggerGroup("script-collectibles-all", true)
end


function add_stamp(name, num)
  ArraySet("astamps", num, name)
end


function show_stamps()
  for key, val in pairs (ArrayListKeys("astamps")) do
    if (tonumber(val) < 10) then
      ColourNote("silver", "black", "     (#" .. val .. ") " .. ArrayGet("astamps", val))

    else
      ColourNote("silver", "black", "    (#" .. val .. ") " .. ArrayGet("astamps", val))
    end
  end

  ArrayDelete("astamps")

  for k, v in ipairs(trigger_style_runs) do
    ColourTell(RGBColourToName(v.textcolour),
               RGBColourToName(v.backcolour),
               v.text)
  end

  Note("")

  EnableTriggerGroup("script-collectibles-stamps", false)
  EnableTriggerGroup("script-collectibles-all", false)
end

]]>

</script>

</muclient>
